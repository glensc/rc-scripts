#!/bin/sh
#
#	$Id: tnldown,v 1.11 1999/11/06 00:25:31 wiget Exp $
#
# Author: Arkadiusz Mi¶kiewicz <misiek@pld.org.pl>
#

DEV=$1

[ -z "$DEV" ] && {
    echo "usage: tnlup <device name>" >&2
    exit 1
}

. /etc/sysconfig/network-scripts/.functions
. /etc/sysconfig/network

TNLCONFIGS="`ls /etc/sysconfig/interfaces/tnlcfg-*|egrep -v '~$'`"
TNLCONFIGS="`egrep -L '^#!' $TNLCONFIGS`"
CONFIG="`egrep -l "^DEVICE=[\"\']*$DEV[\"\']*\$" $TNLCONFIGS`"

if [ -z "$CONFIG" ]; then
    CONFIG="$DEV"
fi

if false; then
[ -f "/etc/sysconfig/interfaces/$CONFIG" ] || CONFIG=tnlcfg-$CONFIG
[ -f "/etc/sysconfig/interfaces/$CONFIG" ] || {
    echo "usage: tnlup <device name>" >&2
    exit 1
}
fi

source_config

if [ "${IPV6_TUNNELCONFIG}" != "yes" ] && [ "${MODE}" = "sit" ] || \
   [ "${IPX}" != "yes" ] && [ "${MODE}" = "ipxip" ] || \
   [ "${IPX}" != "yes" ] && [ "${MODE}" = "ipipx" ]
then
        exit
fi

if [ "${MODE}" = "ipip" ] || [ "${MODE}" = "sit" ] || [ "${MODE}" = "gre" ]; then

	ip tunnel del ${DEVICE}

elif [ "${MODE}" = "ipxip" ] || [ "${MODE}" = "ipipx" ]; then

echo "obs³uga ipxip jeszcze nie zrobiona"

fi
