Summary:	inittab and /etc/rc.d scripts
Summary(de):	inittab und /etc/rc.d Scripts
Summary(fr):	inittab et scripts /etc/rc.d
Summary(pl):	inittab i skrypty startowe z katalogu /etc/rc.d
Summary(tr):	inittab ve /etc/rc.d dosyalarý
Name:		rc-scripts
Version:	@VERSION@
Release:	1
Copyright:	GPL
Group:		Base
Group(pl):	Bazowe	
Source:		%{name}-%{version}.tar.gz
BuildPrereq:	popt-devel
Requires:	mingetty
Requires:	mktemp
Requires:	modutils >= 2.1.121
Requires:	textutils >= 1.22l
Prereq:		/sbin/chkconfig
Obsoletes:	initscripts
Provides:	initscripts
Buildroot:	/tmp/%{name}-%{version}-root

%define		_prefix		/usr
%define		_exec_prefix	/
%define		_sysconfdir	/etc

%description
This package contains the scripts use to boot a system, change run
levels, and shut the system down cleanly.

%description -l de
Dieses Paket enthält die Scripts, die zum Hochfahren des Systems, Ändern
der Betriebsebene und sauberem Herunterfahren des Systems erforderlich sind.
Außerdem enthält es die Scripts, die Netzwerkschnittstellen aktivieren und
deaktivieren.

%description -l fr
Ce package contient les scripts utilisés pour démarrer le systéme,
changer les niveaux d'exécution, et arréter le systéme proprement.
Il contient aussi les scripts qui activent et désactivent la plupart
des inetrfaces réseau.

%description -l pl
Pakiet zawiera skrypty uruchamiane przy starcie i zamykaniu systemu, a
tak¿e przy zmianie poziomu uruchomienia. 

%description -l tr
Bu paket, sistem açmak, çalýþma düzeylerini deðiþtirmek ve sistemi düzgün bir
þekilde kapatmak için gereken dosyalarý içerir. Ayrýca pek çok bilgisayar aðý
arayüzlerini etkinleþtiren ya da edilginleþtiren programcýklar içerir.

%package -n net-scripts
Summary:	network startup scripts
Summary(pl):	skrypty startowe sieci
Group:		Base
Group(pl):	Bazowe	
Requires:	%{name} = %{version}
Requires:	modutils >= 2.1.121
Prereq:		/sbin/chkconfig

%description -n net-scripts
Scripts that activate and deactivate most network interfaces.

%description -l pl -n net-scripts
Skrypty s³u¿±ce do aktywacji i deaktywacji interfejsów sieciowych

%package -n ipchains-setup
Summary:	firewall chains setup script
Summary(pl):	skrypty konfiguruj±cy regu³y filtrowania pakietów IP
Group:		Base
Group(pl):	Bazowe	
Requires:	net-scripts = %{version}
Requires:	ipchains
Prereq:		/sbin/chkconfig

%description -n ipchains-setup
Script making IP firewall rules setup easier 

%description -l pl -n ipchains-setup
Skrypt u³atwiaj±cy konfigurowanie regu³ filtracji pakietów IP

%prep
%setup -q

%build
%configure 
make

%install
rm -rf $RPM_BUILD_ROOT
install -d $RPM_BUILD_ROOT/var/run/netreport

make install  \
	DESTDIR=$RPM_BUILD_ROOT 
	
	
gzip -9nf $RPM_BUILD_ROOT%{_mandir}/man*/* \
	doc/*.txt 

%post
for i in  halt random reboot single  
	do /sbin/chkconfig --add $i
done 
if [ -f /etc/inittab.rpmsave ]; then
	echo "**** Found old /etc/inittab.rpmsave ****"
	echo "/etc/inittab renamed to /etc/inittab.rpmnew"
	mv /etc/inittab /etc/inittab.rpmnew
	echo "/etc/inittab.rpmsave renamed to /etc/inittab."
	mv /etc/inittab.rpmsave /etc/inittab
fi

%preun
if [ "$1" = "0" ]; then
	/sbin/chkconfig --del random
	/sbin/chkconfig --del nfsfs
fi

%post -n net-scripts
/sbin/chkconfig --add network
/sbin/chkconfig --add nfsfs
for l in /etc/sysconfig/network-scripts/ifcfg-* ; do 
  if [ -f "$l" ] ; then
    NEWNAME=`basename $l | sed -e 's /^ifcfg-//'`
    [ -f /etc/sysconfig/interfaces/$NEWNAME ] || cp $l /etc/sysconfig/interfaces/$NEWNAME
  fi
done

%preun -n net-scripts
if [ "$1" = "0" ]; then
	/sbin/chkconfig --del network
fi

%post -n ipchains-setup
/sbin/chkconfig --add ipchains

%preun -n ipchains-setup
if [ "$1" = "0" ]; then
	/sbin/chkconfig --del ipchains
fi

%files
%defattr(644,root,root,754)
%doc doc/sysconfig.txt.gz

%config(noreplace) %verify(not md5 mtime size) %{_sysconfdir}/adjtime
%config(noreplace) %verify(not md5 mtime size) %{_sysconfdir}/inittab

%attr(640,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/system

%attr(644,root,root) %{_sysconfdir}/rc.d/init.d/functions
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/halt
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/killall
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/random
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/reboot
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/shutdwn
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/single

%attr(754,root,root) %{_sysconfdir}/rc.d/rc.sysinit
%attr(754,root,root) %{_sysconfdir}/rc.d/rc.serial
%attr(754,root,root) %{_sysconfdir}/rc.d/rc
%attr(754,root,root) %{_sysconfdir}/rc.d/rc.local
%attr(755,root,root) %{_sysconfdir}/profile.d/lang.sh
%attr(755,root,root) %{_bindir}/doexec
%attr(755,root,root) %{_bindir}/usleep
%attr(755,root,root) %{_sbindir}/setsysfont
%attr(755,root,root) %{_sbindir}/initlog
%attr(755,root,root) %{_sbindir}/loglevel

%{_mandir}/man1/usleep.1.gz
%{_mandir}/man1/doexec.1.gz
%{_mandir}/man1/initlog.1.gz

%files -n net-scripts
%defattr(644,root,root,754)
%doc sysconfig/interfaces/ifc*
%doc sysconfig/interfaces/tun*
%doc sysconfig/interfaces/data/chat-ppp*
%doc doc/net-scripts.txt.gz
%attr(644,root,root) %{_sysconfdir}/rc.d/init.d/functions.network
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/network
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/nfsfs
%attr(750,root,root) %dir /var/run/netreport
%attr(755,root,root) %dir %{_sysconfdir}/sysconfig/interfaces
%attr(755,root,root) %dir %{_sysconfdir}/sysconfig/interfaces/data
%attr(755,root,root) %dir %{_sysconfdir}/ppp
%attr(755,root,root) %{_sysconfdir}/ppp/*

%attr(644,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/network
%attr(644,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/static-routes
%attr(644,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/static-nat

%attr(755,root,root) %{_bindir}/ipcalc
%attr(755,root,root) %{_sbindir}/usernetctl
%attr(755,root,root) %{_sbindir}/netreport

%attr(755,root,root) %{_sbindir}/if*
%attr(755,root,root) %{_sbindir}/tnl*

%{_mandir}/man1/netreport.1.gz
%{_mandir}/man1/usernetctl.1.gz
%{_mandir}/man1/ipcalc.1.gz

%files -n ipchains-setup
%defattr(644,root,root,754)
%doc doc/ipchains-setup.txt.gz
%attr(754,root,root) %{_sysconfdir}/rc.d/init.d/ipchains
#%attr(755,root,root) %dir %{_sysconfdir}/sysconfig/ipchains.d/
#%attr(755,root,root) %dir %{_sysconfdir}/sysconfig/interfaces/data
#%attr(750,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/ipchains.d/*
#%attr(640,root,root) %config(noreplace) %verify(not size mtime md5) %{_sysconfdir}/sysconfig/ipchains

%changelog
* Thu Apr 29 1999 PLD Team <bugs@pld.org.pl>
  [0.0.5-1]
- automake/autoconf support

* Wed Apr 28 1999 PLD Team <bugs@pld.org.pl>
  [0.0.4-1]
- added ipchains-setup  

* Thu Apr 22 1999 PLD Team <bugs@pld.org.pl>
  [0.0.3-1]
- split into two packages: rc-scripts & net-scripts  
- directory structure changed - only config in /etc

* Tue Mar 23 1999 PLD Team <bugs@pld.org.pl>
  [0.0.2-1]
- be more verbose while upgrading when /etc/inittab.rpmsave is found,
- added seting NETWORK="no" variable to when /etc/sysconfig/network is not present
  or when NETWORK in this file is not defined.

* Sun Mar 21 1999 PLD Team <bugs@pld.org.pl>
  [0.0.1-1]
- added /etc/sysconfig/system,
- removed man group from man pages,
- added in %post not replacing /etc/inittab on upgrade from initscripts,
- removed %config from scripts.

* Fri Mar 19 1999 PLD Team <bugs@pld.org.pl>
- Modified handling ppp links. Added new features to ifcfg-ppp
  and changed syntax of chat scripts for ppp.
- First Release.
- Package based on RedHat's initscripts-3.78.
